// Generated by CoffeeScript 2.7.0
var calculate, expected_score, performance, performance_rating, summa;

summa = function(arr) {
  var i, item, len, res;
  res = 0;
  for (i = 0, len = arr.length; i < len; i++) {
    item = arr[i];
    res += item;
  }
  return res;
};

expected_score = function(ratings, own_rating) {
  var rating;
  return summa((function() {
    var i, len, results;
    results = [];
    for (i = 0, len = ratings.length; i < len; i++) {
      rating = ratings[i];
      results.push(1 / (1 + 10 ** ((rating - own_rating) / 400)));
    }
    return results;
  })());
};

performance_rating = function(pp, ratings) {
  var hi, lo, rating;
  lo = 0;
  hi = 4000;
  while (Math.abs(hi - lo) > 0.001) {
    rating = (lo + hi) / 2;
    if (pp > expected_score(ratings, rating)) {
      lo = rating;
    } else {
      hi = rating;
    }
  }
  return rating.toFixed(6);
};

performance = function(pp, elos) {
  return performance_rating(pp, elos);
};

calculate = function() {
  var data, elos, input, item, pp;
  input = document.getElementById("INPUT").value;
  data = input.trim().split(' ');
  if (data.length <= 1) {
    return;
  }
  pp = parseFloat(data.pop());
  elos = (function() {
    var i, len, results;
    results = [];
    for (i = 0, len = data.length; i < len; i++) {
      item = data[i];
      results.push(parseFloat(item));
    }
    return results;
  })();
  return document.getElementById("PR").innerText = performance(pp, elos);
};

calculate();

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiLi5cXC4uXFwuLlxcLi5cXC4uXFwiLCJzb3VyY2VzIjpbImNvbnRlbnRcXGtsdWJiZW5cXG1lZGxlbW1hclxcY2hyaXN0ZXItbmlsc3NvblxcUGVyZm9ybWFuY2VfQ2FsY3VsYXRvclxcaW5kZXguY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFBLFNBQUEsRUFBQSxjQUFBLEVBQUEsV0FBQSxFQUFBLGtCQUFBLEVBQUE7O0FBQUEsS0FBQSxHQUFRLFFBQUEsQ0FBQyxHQUFELENBQUE7QUFDUixNQUFBLENBQUEsRUFBQSxJQUFBLEVBQUEsR0FBQSxFQUFBO0VBQUMsR0FBQSxHQUFNO0VBQ04sS0FBQSxxQ0FBQTs7SUFDQyxHQUFBLElBQU87RUFEUjtTQUVBO0FBSk87O0FBTVIsY0FBQSxHQUFpQixRQUFBLENBQUMsT0FBRCxFQUFVLFVBQVYsQ0FBQTtBQUF3QixNQUFBO1NBQUMsS0FBQTs7QUFBTztJQUFBLEtBQUEseUNBQUE7O21CQUFBLENBQUEsR0FBSSxDQUFDLENBQUEsR0FBSSxFQUFBLElBQUksQ0FBQyxDQUFDLE1BQUEsR0FBUyxVQUFWLENBQUEsR0FBd0IsR0FBekIsQ0FBVDtJQUFKLENBQUE7O01BQVA7QUFBekI7O0FBRWpCLGtCQUFBLEdBQXFCLFFBQUEsQ0FBQyxFQUFELEVBQUssT0FBTCxDQUFBO0FBQ3JCLE1BQUEsRUFBQSxFQUFBLEVBQUEsRUFBQTtFQUFDLEVBQUEsR0FBSztFQUNMLEVBQUEsR0FBSztBQUNMLFNBQU0sSUFBSSxDQUFDLEdBQUwsQ0FBUyxFQUFBLEdBQUssRUFBZCxDQUFBLEdBQW9CLEtBQTFCO0lBQ0MsTUFBQSxHQUFTLENBQUMsRUFBQSxHQUFLLEVBQU4sQ0FBQSxHQUFZO0lBQ3JCLElBQUcsRUFBQSxHQUFLLGNBQUEsQ0FBZSxPQUFmLEVBQXdCLE1BQXhCLENBQVI7TUFDQyxFQUFBLEdBQUssT0FETjtLQUFBLE1BQUE7TUFHQyxFQUFBLEdBQUssT0FITjs7RUFGRDtTQU1BLE1BQU0sQ0FBQyxPQUFQLENBQWUsQ0FBZjtBQVRvQjs7QUFXckIsV0FBQSxHQUFjLFFBQUEsQ0FBQyxFQUFELEVBQUksSUFBSixDQUFBO1NBQWEsa0JBQUEsQ0FBbUIsRUFBbkIsRUFBc0IsSUFBdEI7QUFBYjs7QUFFZCxTQUFBLEdBQVksUUFBQSxDQUFBLENBQUE7QUFDWixNQUFBLElBQUEsRUFBQSxJQUFBLEVBQUEsS0FBQSxFQUFBLElBQUEsRUFBQTtFQUFDLEtBQUEsR0FBUSxRQUFRLENBQUMsY0FBVCxDQUF3QixPQUF4QixDQUFnQyxDQUFDO0VBQ3pDLElBQUEsR0FBTyxLQUFLLENBQUMsSUFBTixDQUFBLENBQVksQ0FBQyxLQUFiLENBQW1CLEdBQW5CO0VBQ1AsSUFBRyxJQUFJLENBQUMsTUFBTCxJQUFlLENBQWxCO0FBQXlCLFdBQXpCOztFQUNBLEVBQUEsR0FBSyxVQUFBLENBQVcsSUFBSSxDQUFDLEdBQUwsQ0FBQSxDQUFYO0VBQ0wsSUFBQTs7QUFBUTtJQUFBLEtBQUEsc0NBQUE7O21CQUFBLFVBQUEsQ0FBVyxJQUFYO0lBQUEsQ0FBQTs7O1NBQ1IsUUFBUSxDQUFDLGNBQVQsQ0FBd0IsSUFBeEIsQ0FBNkIsQ0FBQyxTQUE5QixHQUEwQyxXQUFBLENBQVksRUFBWixFQUFnQixJQUFoQjtBQU4vQjs7QUFRWixTQUFBLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJzdW1tYSA9IChhcnIpIC0+XHJcblx0cmVzID0gMFxyXG5cdGZvciBpdGVtIGluIGFyclxyXG5cdFx0cmVzICs9IGl0ZW1cclxuXHRyZXNcclxuXHJcbmV4cGVjdGVkX3Njb3JlID0gKHJhdGluZ3MsIG93bl9yYXRpbmcpIC0+IHN1bW1hICgxIC8gKDEgKyAxMCoqKChyYXRpbmcgLSBvd25fcmF0aW5nKSAvIDQwMCkpIGZvciByYXRpbmcgaW4gcmF0aW5ncylcclxuXHJcbnBlcmZvcm1hbmNlX3JhdGluZyA9IChwcCwgcmF0aW5ncykgLT5cclxuXHRsbyA9IDBcclxuXHRoaSA9IDQwMDBcclxuXHR3aGlsZSBNYXRoLmFicyhoaSAtIGxvKSA+IDAuMDAxXHJcblx0XHRyYXRpbmcgPSAobG8gKyBoaSkgLyAyXHJcblx0XHRpZiBwcCA+IGV4cGVjdGVkX3Njb3JlIHJhdGluZ3MsIHJhdGluZ1xyXG5cdFx0XHRsbyA9IHJhdGluZ1xyXG5cdFx0ZWxzZVxyXG5cdFx0XHRoaSA9IHJhdGluZ1xyXG5cdHJhdGluZy50b0ZpeGVkIDZcclxuXHJcbnBlcmZvcm1hbmNlID0gKHBwLGVsb3MpIC0+IHBlcmZvcm1hbmNlX3JhdGluZyBwcCxlbG9zXHJcblxyXG5jYWxjdWxhdGUgPSAtPlxyXG5cdGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJJTlBVVFwiKS52YWx1ZVxyXG5cdGRhdGEgPSBpbnB1dC50cmltKCkuc3BsaXQgJyAnXHJcblx0aWYgZGF0YS5sZW5ndGggPD0gMSB0aGVuIHJldHVyblxyXG5cdHBwID0gcGFyc2VGbG9hdCBkYXRhLnBvcCgpXHJcblx0ZWxvcyA9IChwYXJzZUZsb2F0IGl0ZW0gZm9yIGl0ZW0gaW4gZGF0YSlcclxuXHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIlBSXCIpLmlubmVyVGV4dCA9IHBlcmZvcm1hbmNlIHBwLCBlbG9zXHJcblxyXG5jYWxjdWxhdGUoKVxyXG4iXX0=
//# sourceURL=c:\github\SrS\content\klubben\medlemmar\christer-nilsson\Performance_Calculator\index.coffee